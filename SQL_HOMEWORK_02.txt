SQL HomeWork 2. JOINs

Подключится к 
Host: 159.69.151.133
Port: 5056
DB: qa_db_2
User: user_22_22
Pass: 123


    1. Вывести всех работников чьи зарплаты есть в базе, вместе с зарплатами.
 
SELECT employee_name, monthly_salary
FROM employees INNER JOIN employees_salary
ON employees.id = employees_salary.id; 


    2. Вывести всех работников у которых ЗП меньше 2000.
 
SELECT employee_name, monthly_salary
FROM employees JOIN employees_salary
ON employees.id = employees_salary.id 
WHERE monthly_salary < 2000;


    3. Вывести все зарплатные позиции, но работник по ним не назначен. 
	(ЗП есть, но не понятно кто её получает.)

SELECT employee_name, monthly_salary
FROM employees FULL JOIN employees_salary
ON employees.id = employees_salary.id
WHERE employee_name IS NULL;

Комментарий: все зарплаты распределены.


Вывод зарплатных позиций по не назначенным ДОЛЖНОСТЯМ:

SELECT role_name, monthly_salary
FROM roles FULL JOIN employees_salary
ON roles.id = employees_salary.id
WHERE role_name IS NULL;


    4. Вывести все зарплатные позиции  меньше 2000 но работник по ним не назначен. 
	(ЗП есть, но не понятно кто её получает.)

Вывод зарплатных позиций по не назначенным ДОЛЖНОСТЯМ:

SELECT role_name, employees_salary.monthly_salary
FROM roles FULL JOIN employees_salary
ON roles.id = employees_salary.id
WHERE role_name IS NULL and monthly_salary < 2000;


    5. Найти всех работников кому не начислена ЗП.

SELECT employee_name, monthly_salary
FROM employees LEFT JOIN employees_salary
ON employees.id = employees_salary.id
WHERE monthly_salary IS NULL;


    6. Вывести всех работников с названиями их должности.

SELECT employee_name, role_name
FROM employees JOIN roles
ON employees.id = roles.id;


    7. Вывести имена и должность только Java разработчиков.

SELECT employee_name, role_name
FROM employees JOIN roles
ON employees.id = roles.id
WHERE role_name LIKE '%Java %';


    8. Вывести имена и должность только Python разработчиков.

SELECT employee_name, role_name
FROM employees JOIN roles
ON employees.id = roles.id
WHERE role_name LIKE '%Python%';


    9. Вывести имена и должность всех QA инженеров.

SELECT employee_name, role_name
FROM employees JOIN roles
ON employees.id = roles.id
WHERE role_name LIKE '%QA engineer%';


    10. Вывести имена и должность ручных QA инженеров.

SELECT employee_name, role_name
FROM employees JOIN roles
ON employees.id = roles.id
WHERE role_name LIKE '%Manual QA engineer%';


    11. Вывести имена и должность автоматизаторов QA

SELECT employee_name, role_name
FROM employees JOIN roles
ON employees.id = roles.id
WHERE role_name LIKE '%Automation QA engineer%';


    12. Вывести имена и зарплаты Junior специалистов

без показа должности (имена и зарплаты):

SELECT employee_name, monthly_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name LIKE '%Junior%';


    13. Вывести имена и зарплаты Middle специалистов

SELECT employee_name, monthly_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name LIKE '%Middle%';


    14. Вывести имена и зарплаты Senior специалистов

SELECT employee_name, monthly_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name LIKE '%Senior%';


    15. Вывести зарплаты Java разработчиков

SELECT monthly_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name LIKE '%Java%';


    16. Вывести зарплаты Python разработчиков

SELECT monthly_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name LIKE '%Python%';


    17. Вывести имена и зарплаты Junior Python разработчиков

SELECT employee_name, monthly_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name LIKE '%Junior Python%';


    18. Вывести имена и зарплаты Middle JS разработчиков

SELECT employee_name, monthly_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name LIKE '%Middle JavaScript%';


    19. Вывести имена и зарплаты Senior Java разработчиков

SELECT employee_name, monthly_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name LIKE '%Senior Java %';


    20. Вывести зарплаты Junior QA инженеров

SELECT monthly_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name LIKE '%Junior % QA engineer%';


    21. Вывести среднюю зарплату всех Junior специалистов

SELECT AVG (monthly_salary) AS average_salary_Junior
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name LIKE '%Junior%';


    22. Вывести сумму зарплат JS разработчиков

SELECT SUM (monthly_salary)
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name LIKE '%JavaScript%';


    23. Вывести минимальную ЗП QA инженеров

SELECT MIN (monthly_salary) AS min_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name LIKE '%QA engineer%';


    24. Вывести максимальную ЗП QA инженеров

SELECT MAX (monthly_salary) AS max_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name LIKE '%QA engineer%';


    25. Вывести количество QA инженеров

Общее количество:

SELECT count(role_name)
AS count_qa_engineer
FROM roles
WHERE role_name LIKE '%QA engineer%';
	
Количество в каждой группе: 

SELECT role_name, count(employee_name) 
FROM employees JOIN roles
ON employees.id = roles.id
WHERE role_name LIKE '%QA engineer%'
group by role_name;

или 

SELECT role_name, count(role_name)
FROM roles
WHERE role_name LIKE '%QA engineer%'
group by role_name;


    26. Вывести количество Middle специалистов.

SELECT count(role_name)
AS count_middle
FROM roles
WHERE role_name LIKE '%Middle%';


    27. Вывести количество разработчиков

SELECT count(role_name)
AS developer
FROM roles
WHERE role_name LIKE '%developer%';


    28. Вывести фонд (сумму) зарплаты разработчиков.

SELECT sum(monthly_salary)
as sum_salary_developer
FROM roles JOIN employees_salary
ON roles.id = employees_salary.id 
WHERE role_name LIKE '%developer%';


    29. Вывести имена, должности и ЗП всех специалистов по возрастанию

SELECT employee_name, role_name, monthly_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
ORDER BY monthly_salary ASC;

или 

SELECT employee_name, role_name, monthly_salary
FROM employees FULL JOIN roles
ON employees.id = roles.id
FULL JOIN employees_salary
ON employees.id = employees_salary.id
WHERE role_name NOTNULL and monthly_salary NOTNULL
ORDER BY monthly_salary ASC;


    30. Вывести имена, должности и ЗП всех специалистов по возрастанию 
	у специалистов у которых ЗП от 1700 до 2300

SELECT employee_name, role_name, monthly_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE monthly_salary BETWEEN 1700 AND 2300
ORDER BY monthly_salary ASC;


    31. Вывести имена, должности и ЗП всех специалистов по возрастанию 
	у специалистов у которых ЗП меньше 2300

SELECT employee_name, role_name, monthly_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE monthly_salary < 2300
ORDER BY monthly_salary ASC;


    32. Вывести имена, должности и ЗП всех специалистов по возрастанию 
	у специалистов у которых ЗП равна 1100, 1500, 2000
	
SELECT employee_name, role_name, monthly_salary
FROM employees JOIN roles
ON employees.id = roles.id
JOIN employees_salary
ON employees.id = employees_salary.id
WHERE monthly_salary = 1100 OR monthly_salary = 1500 OR monthly_salary = 2000
ORDER BY monthly_salary ASC;